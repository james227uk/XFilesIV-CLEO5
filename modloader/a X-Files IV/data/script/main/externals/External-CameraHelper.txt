//==========================================================================================================================================================================================================
//------------------------------------------------------------------------------------------- GTA X-Files IV (2024) ----------------------------------------------------------------------------------------
//---------------------------------------------------------------------------------------------- By james227uk ---------------------------------------------------------------------------------------------
//==========================================================================================================================================================================================================
// Name:        Camera Helper
// Description: This script is a development tool used to help perfect camera angles.
// Path:        main\externals\External-CameraHelper.txt
// Trigger:     Upon pressing activation buttons.
//==========================================================================================================================================================================================================
float fCameraPosX
float fCameraPosY
float fCameraPosZ
float fCameraPointX
float fCameraPointY
float fCameraPointZ
float fPlayerPosX
float fPlayerPosY
float fPlayerPosZ
float fCameraTargetRange = 100.0

script_name 'DBGCAMH'
Debugger.LogLine({Filename:}logPath, {Timestamp:}True, {Text:}"[External-CameraHelper] [INFO] Loaded external script 'External-CameraHelper'.")

while true
    wait 0
    // Record camera coordinates
    if Pad.TestCheat("[")
    then
        Char.GetCoordinates({Char:}$scplayer, {StoreXTo:}fPlayerPosX, {StoreYTo:}fPlayerPosY, {StoreZTo:}fPlayerPosZ)
        Camera.GetThirdPersonTarget({Range:}fCameraTargetRange, {SourceX:}fPlayerPosX, {SourceY:}fPlayerPosX, {SourceZ:}fPlayerPosX, {OutputPosX:}fCameraPosX, {OutputPosY:}fCameraPosY, {OutputPosZ:}fCameraPosZ, {OutputPointX:}fCameraPointX, {OutputPointY:}fCameraPointY,{OutputPointZ:}fCameraPointZ)
        Text.PrintStringNow({Text:}"Got pos coordinates", {Time:}1000)
    end

    // Test camera position
    if Pad.TestCheat("]")
    then
        Camera.SetFixedPosition({X:}fPlayerPosX, {Y:}fPlayerPosY, {Z:}fPlayerPosZ, {HeadingX:}0.0, {HeadingY:}0.0, {HeadingZ:}0.0)
        Camera.PointAtPoint({X:}fCameraPointX, {Y:}fCameraPointY, {Z:}fCameraPointZ, 2)
        
        // Stall until the player lets go of the key.
        repeat
            wait 0
        until not Pad.TestCheat("]") 
        
        // Stall until the player presses the key again to reset the camera.
        wait 250
        repeat
            wait 0
        until Pad.TestCheat("]")
        Camera.RestoreJumpcut()       
    end
    
    // Write the coordinates to the log file.
    if Pad.TestCheat("#") // ]
    then
        Debugger.LogLine(logPath, True, "[External-CameraHelper] [INFO] Camera Position: %f, %f, %f", fPlayerPosX, fPlayerPosY, fPlayerPosZ)
        Debugger.LogLine(logPath, True, "[External-CameraHelper] [INFO] Camera Point: %f, %f, %f", fCameraPointX, fCameraPointY, fCameraPointZ)
        Text.PrintStringNow("Wrote coordinates to log.", 1000)
        break
    end    
end

terminate_this_script